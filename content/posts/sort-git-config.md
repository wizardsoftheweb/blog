---
title: "Sort git Config"
slug: "sort-git-config"
date: "2018-02-25T06:00:00.000Z"
author: "CJ Harries"
tags: 
  - CLI
  - awk
  - git
  - sort
  - Linux
  - terminal
  - scripting
  - bash
---

As I was updating some `gitflow` config today, I noticed that my `.gitconfig` is a little messy. Like many things, it's grown organically and I've just never thought about tidying it up. It doesn't have to be organized, but neat and tidy files always make things more fun.

Sorting `.gitconfig` was a bit more challenging than I was expecting. A naive sort mixes sections and values.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="p">|</span> sort<br><span class="go" style="color:#888">    autocorrect = 1</span><br><span class="go" style="color:#888">    autocrlf = input</span><br><span class="go" style="color:#888">    clean = git-lfs clean %f</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">    default = matching</span><br><span class="go" style="color:#888">    editor = nano</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">    required = true</span><br><span class="go" style="color:#888">    smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">[user]</span><br></pre></div>
</td></tr></table>

A more complicated `sort` might be able to get the job done, but I wasn't able to figure out a good way to set up the fields and keys properly. If you have a pure `sort` solution, I'd love to see it.

I spent a good chunk of time glossing over `awk` array sorts and block sorting techniques trying to find a solution I thought I'd read once. Then it hit me. Rather than trying to pipe several clever `awk` and `sort` combos, I could just add more information, `sort`, and remove the extra information.

First thing to do is sanitize the leading spaces. I typically replace tabs with spaces but `git` likes `tab`bed files.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">    clean = git-lfs clean %f</span><br><span class="go" style="color:#888">    smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">    required = true</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">    autocorrect = 1</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">    autocrlf = input</span><br><span class="go" style="color:#888">    editor = nano</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">    default = matching</span><br></pre></div>
</td></tr></table>

With a guaranteed `tab`, we can abuse the field separator in `awk` to access the section headings.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { print $1 }'</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">[user]</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">[push]</span><br></pre></div>
</td></tr></table>

By the same token, we can also access the config values.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$2 { print $2 }'</span><br><span class="go" style="color:#888">clean = git-lfs clean %f</span><br><span class="go" style="color:#888">smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">required = true</span><br><span class="go" style="color:#888">autocorrect = 1</span><br><span class="go" style="color:#888">autocrlf = input</span><br><span class="go" style="color:#888">editor = nano</span><br><span class="go" style="color:#888">default = matching</span><br></pre></div>
</td></tr></table>

By putting the two together, we make a more verbose line perfect for sorting.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { current = $1; print current } $2 { print current "\t" $2}'</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">[filter "lfs"]  clean = git-lfs clean %f</span><br><span class="go" style="color:#888">[filter "lfs"]  smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">[filter "lfs"]  required = true</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">[help]  autocorrect = 1</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">[core]  autocrlf = input</span><br><span class="go" style="color:#888">[core]  editor = nano</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">[push]  default = matching</span><br><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { current = $1; print current } $2 { print current "\t" $2}'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sort<br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">[core]  autocrlf = input</span><br><span class="go" style="color:#888">[core]  editor = nano</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">[filter "lfs"]  clean = git-lfs clean %f</span><br><span class="go" style="color:#888">[filter "lfs"]  required = true</span><br><span class="go" style="color:#888">[filter "lfs"]  smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">[help]  autocorrect = 1</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">[push]  default = matching</span><br></pre></div>
</td></tr></table>

We can regain the headings by looking for entries without a second field.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { current = $1; print current } $2 { print current "\t" $2}'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sort <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'!$2 {print $1}'</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">[user]</span><br></pre></div>
</td></tr></table>

Similarly, the values can be pulled out from rows with both a first and second field.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { current = $1; print current } $2 { print current "\t" $2}'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sort <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 &amp;&amp; $2 { print $2 }'</span><br><span class="go" style="color:#888">autocrlf = input</span><br><span class="go" style="color:#888">editor = nano</span><br><span class="go" style="color:#888">clean = git-lfs clean %f</span><br><span class="go" style="color:#888">required = true</span><br><span class="go" style="color:#888">smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">autocorrect = 1</span><br><span class="go" style="color:#888">default = matching</span><br></pre></div>
</td></tr></table>

Now it's just a simple matter of putting everything back together.

<table class="highlighttable" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><tr><td class="code" style="border:none; background-image:none; background-position:center; background-repeat:no-repeat; padding:10px 0">
<div class="highlight" style='border-radius:5px; display:block; font-family:Consolas, "Courier New", monospace; min-width:300px; overflow:auto; width:100%; background:#272822; color:#f8f8f2' width="100%"><pre style="background:#272822; color:#f8f8f2; border:none; font-size:1em; line-height:125%; padding:10px; margin-bottom:0; margin-top:0; padding-bottom:0; padding-top:0"><span></span><span class="gp" style="color:#66d9ef">$</span> cat ~/.gitconfig <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sed <span class="s1" style="color:#e6db74">'s/   +/\t/g'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'$1 { current = $1; print current } $2 { print current "\t" $2}'</span> <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> sort <span class="se" style="color:#ae81ff">\</span><br>    <span class="p">|</span> awk -F <span class="s1" style="color:#e6db74">'\t'</span> <span class="s1" style="color:#e6db74">'!$2 {print $1} $1 &amp;&amp; $2 { print "\t" $2 }'</span><br><span class="go" style="color:#888">[core]</span><br><span class="go" style="color:#888">    autocrlf = input</span><br><span class="go" style="color:#888">    editor = nano</span><br><span class="go" style="color:#888">[filter "lfs"]</span><br><span class="go" style="color:#888">    clean = git-lfs clean %f</span><br><span class="go" style="color:#888">    required = true</span><br><span class="go" style="color:#888">    smudge = git-lfs smudge %f</span><br><span class="go" style="color:#888">[help]</span><br><span class="go" style="color:#888">    autocorrect = 1</span><br><span class="go" style="color:#888">[push]</span><br><span class="go" style="color:#888">    default = matching</span><br></pre></div>
</td></tr></table>
